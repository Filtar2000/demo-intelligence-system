<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Label Match â€” DIS</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Space+Grotesk:wght@500;600;700&family=JetBrains+Mono:wght@500;600;700&display=swap"
        rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="styles/main.css">

    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>

    <nav class="navbar">
        <div class="logo">DIS</div>
        <ul class="nav-links">
            <li><a href="dashboard.html">Dashboard</a></li>
            <li><a href="analysis.html">Analysis</a></li>
            <li><a href="label-fit.html" class="active">Label Match</a></li>
            <li><a href="crm.html">CRM</a></li>
        </ul>
        <a href="#" class="btn-login" id="loginBtn">Login</a>
    </nav>

    <main class="analysis-container">
        <section class="analysis-header">
            <h1>Label Match</h1>
            <p>See which labels fit your sound, based on genre, mood, and energy.</p>
        </section>

        <!-- Empty State (shown when no analysis data) -->
        <div id="empty-state" class="hidden" style="text-align:center; padding: 60px 20px;">
            <div style="font-size: 3rem; margin-bottom: 16px;">ðŸŽ§</div>
            <h2 style="color: var(--text-primary); font-size: 1.4rem; margin-bottom: 8px;">No track analyzed yet</h2>
            <p
                style="color: var(--text-secondary); margin-bottom: 24px; max-width: 400px; margin-left: auto; margin-right: auto;">
                Analyze a track first â€” we use your genre, mood, and energy selections to find labels that fit your
                sound.</p>
            <a href="analysis.html" class="btn-primary"
                style="display: inline-block; text-decoration: none; padding: 12px 32px;">Go to Track Check</a>
        </div>

        <!-- Loader -->
        <div id="loader" class="loader"></div>

        <!-- Results Grid -->
        <div id="labels-grid" class="labels-grid hidden"></div>

        <div id="no-results" class="hidden" style="text-align: center; margin-top: 50px; color: #888;">
            <p>No matching labels found. Try analyzing a different track.</p>
            <a href="analysis.html" class="btn-secondary" style="margin-top: 20px;">Analyze New Track</a>
        </div>

        <!-- Label Detail Modal -->
        <div id="label-detail-modal" class="modal-overlay hidden">
            <div class="modal-content label-detail-content">
                <button class="close-modal" id="close-label-detail">&times;</button>
                <div class="label-detail-header">
                    <h2 id="ld-name"></h2>
                    <span id="ld-score" class="ld-score-badge"></span>
                </div>
                <p id="ld-bio" class="ld-bio"></p>
                <div id="ld-tags" class="ld-tags"></div>
                <div class="ld-info-grid">
                    <div class="ld-info-item" id="ld-energy-wrap"><span class="ld-info-label">Energy</span><span
                            id="ld-energy" class="ld-info-value"></span></div>
                    <div class="ld-info-item" id="ld-email-wrap"><span class="ld-info-label">Demo Email</span><a
                            id="ld-email" class="ld-info-value ld-email-link" href="#"></a></div>
                    <div class="ld-info-item" id="ld-website-wrap"><span class="ld-info-label">Website</span><a
                            id="ld-website" class="ld-info-value ld-email-link" href="#" target="_blank"></a></div>
                    <div class="ld-info-item" id="ld-sc-wrap"><span class="ld-info-label">SoundCloud</span><a
                            id="ld-soundcloud" class="ld-info-value ld-email-link" href="#" target="_blank">Listen â†’</a>
                    </div>
                </div>
                <div class="ld-actions">
                    <button id="ld-generate-pitch" class="btn-primary">âœ‰ Draft Pitch Email</button>
                </div>
            </div>
        </div>

        <!-- Pitch Email Modal -->
        <div id="pitch-modal" class="modal-overlay hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">âœ‰ Pitch Draft</h2>
                    <button id="close-modal" class="close-modal">&times;</button>
                </div>

                <div id="pitch-loading" class="pitch-loading">
                    <div class="loader"></div>
                    <p>Writing your pitch...</p>
                </div>

                <div id="pitch-content" class="hidden">
                    <div class="tabs">
                        <button class="tab-btn active" data-tab="0">Formal</button>
                        <button class="tab-btn" data-tab="1">Direct</button>
                        <button class="tab-btn" data-tab="2">Creative</button>
                    </div>

                    <div class="email-preview">
                        <div id="email-subject" class="email-subject">Subject: ...</div>
                        <div id="email-body" class="email-body"></div>
                    </div>

                    <div class="pitch-actions" style="display: flex; gap: 10px;">
                        <button id="copy-btn" class="btn-secondary" style="flex: 1;">ðŸ“‹ Copy Email</button>
                        <button id="mailto-btn" class="btn-primary" style="flex: 1;">ðŸ“§ Open in Mail App</button>
                    </div>

                    <div class="pitch-track-actions"
                        style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(255,255,255,0.08); text-align: center;">
                        <button id="mark-sent-btn" class="btn-secondary"
                            style="width: 100%; background: rgba(62,207,142,0.1); border-color: rgba(62,207,142,0.3); color: #3ecf8e;">
                            âœ“ Mark as Sent â€” Track in Submissions
                        </button>
                        <p id="mark-sent-confirm" class="hidden"
                            style="color: #3ecf8e; margin-top: 10px; font-size: 0.9rem; font-weight: 500;">
                            âœ… Tracked! You'll find it in your Submissions.
                        </p>
                    </div>
                </div>

                <div id="pitch-error" class="pitch-error hidden">
                    <p>âš  Failed to generate pitch. Please try again.</p>
                    <button id="retry-pitch" class="btn-secondary">Retry</button>
                </div>
            </div>
        </div>

    </main>

    <script type="module" src="src/label-matcher.js"></script>
</body>

</html>